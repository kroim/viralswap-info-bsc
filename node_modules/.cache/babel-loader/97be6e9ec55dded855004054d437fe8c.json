{"ast":null,"code":"var _jsxFileName = \"B:\\\\2021\\\\1219_ViralCoin\\\\work\\\\NewSubgraph\\\\pancake-info-v1\\\\src\\\\components\\\\Search\\\\index.js\";\nimport React, { useState, useEffect, useMemo, useRef } from 'react';\nimport styled from 'styled-components';\nimport Row, { RowFixed } from '../Row';\nimport TokenLogo from '../TokenLogo';\nimport { Search as SearchIcon, X } from 'react-feather';\nimport { BasicLink } from '../Link';\nimport { useAllTokenData, useTokenData } from '../../contexts/TokenData';\nimport { useAllPairData, usePairData } from '../../contexts/PairData';\nimport DoubleTokenLogo from '../DoubleLogo';\nimport { useMedia } from 'react-use';\nimport { useAllPairsInUniswap, useAllTokensInUniswap } from '../../contexts/GlobalData';\nimport { OVERVIEW_TOKEN_BLACKLIST, PAIR_BLACKLIST } from '../../constants';\nimport { transparentize } from 'polished';\nimport { client } from '../../apollo/client';\nimport { PAIR_SEARCH, TOKEN_SEARCH } from '../../apollo/queries';\nimport FormattedName from '../FormattedName';\nimport { TYPE } from '../../Theme';\nimport { updateNameData } from '../../utils/data';\nconst Container = styled.div`\n  height: 48px;\n  z-index: 30;\n  position: relative;\n\n  @media screen and (max-width: 600px) {\n    width: 100%;\n  }\n`;\nconst Wrapper = styled.div`\n  display: flex;\n  position: relative;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  padding: 12px 16px;\n  border-radius: 12px;\n  background: ${({\n  theme,\n  small,\n  open\n}) => small ? open ? transparentize(0.4, theme.bg1) : 'none' : transparentize(0.4, theme.bg6)};\n  border-bottom-right-radius: ${({\n  open\n}) => open ? '0px' : '12px'};\n  border-bottom-left-radius: ${({\n  open\n}) => open ? '0px' : '12px'};\n  z-index: 9999;\n  width: 100%;\n  min-width: 300px;\n  box-sizing: border-box;\n  box-shadow: ${({\n  open,\n  small\n}) => !open && !small ? '0px 24px 32px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 0px 1px rgba(0, 0, 0, 0.04) ' : 'none'};\n  @media screen and (max-width: 500px) {\n    background: ${({\n  theme\n}) => transparentize(0.4, theme.bg1)};\n    box-shadow: ${({\n  open\n}) => !open ? '0px 24px 32px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 0px 1px rgba(0, 0, 0, 0.04) ' : 'none'};\n  }\n`;\nconst Input = styled.input`\n  position: relative;\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  background: none;\n  border: none;\n  outline: none;\n  width: 100%;\n  color: ${({\n  theme\n}) => theme.text1};\n  font-size: ${({\n  large\n}) => large ? '20px' : '14px'};\n\n  ::placeholder {\n    color: ${({\n  theme\n}) => theme.text3};\n    font-size: 16px;\n  }\n\n  @media screen and (max-width: 640px) {\n    ::placeholder {\n      font-size: 1rem;\n    }\n  }\n`;\nconst SearchIconLarge = styled(SearchIcon)`\n  height: 20px;\n  width: 20px;\n  margin-right: 0.5rem;\n  position: absolute;\n  right: 10px;\n  pointer-events: none;\n  color: ${({\n  theme\n}) => theme.text3};\n`;\nconst CloseIcon = styled(X)`\n  height: 20px;\n  width: 20px;\n  margin-right: 0.5rem;\n  position: absolute;\n  right: 10px;\n  color: ${({\n  theme\n}) => theme.text3};\n  :hover {\n    cursor: pointer;\n  }\n`;\nconst Menu = styled.div`\n  display: flex;\n  flex-direction: column;\n  z-index: 9999;\n  width: 100%;\n  top: 50px;\n  max-height: 540px;\n  overflow: auto;\n  left: 0;\n  padding-bottom: 20px;\n  background: ${({\n  theme\n}) => theme.bg6};\n  border-bottom-right-radius: 12px;\n  border-bottom-left-radius: 12px;\n  box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04),\n    0px 24px 32px rgba(0, 0, 0, 0.04);\n  display: ${({\n  hide\n}) => hide && 'none'};\n`;\nconst MenuItem = styled(Row)`\n  padding: 1rem;\n  font-size: 0.85rem;\n  & > * {\n    margin-right: 6px;\n  }\n  :hover {\n    cursor: pointer;\n    background-color: ${({\n  theme\n}) => theme.bg2};\n  }\n`;\nconst Heading = styled(Row)`\n  padding: 1rem;\n  display: ${({\n  hide = false\n}) => hide && 'none'};\n`;\nconst Gray = styled.span`\n  color: #888d9b;\n`;\nconst Blue = styled.span`\n  color: #2172e5;\n  :hover {\n    cursor: pointer;\n  }\n`;\nexport const Search = ({\n  small = false\n}) => {\n  let allTokens = useAllTokensInUniswap();\n  const allTokenData = useAllTokenData();\n  let allPairs = useAllPairsInUniswap();\n  const allPairData = useAllPairData();\n  const [showMenu, toggleMenu] = useState(false);\n  const [value, setValue] = useState('');\n  const [, toggleShadow] = useState(false);\n  const [, toggleBottomShadow] = useState(false); // fetch new data on tokens and pairs if needed\n\n  useTokenData(value);\n  usePairData(value);\n  const below700 = useMedia('(max-width: 700px)');\n  const below470 = useMedia('(max-width: 470px)');\n  const below410 = useMedia('(max-width: 410px)');\n  useEffect(() => {\n    if (value !== '') {\n      toggleMenu(true);\n    } else {\n      toggleMenu(false);\n    }\n  }, [value]);\n  const [searchedTokens, setSearchedTokens] = useState([]);\n  const [searchedPairs, setSearchedPairs] = useState([]);\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        if ((value === null || value === void 0 ? void 0 : value.length) > 0) {\n          var _tokens$data$asSymbol;\n\n          let tokens = await client.query({\n            query: TOKEN_SEARCH,\n            variables: {\n              value: value ? value.toUpperCase() : '',\n              id: value\n            }\n          });\n          let pairs = await client.query({\n            query: PAIR_SEARCH,\n            variables: {\n              tokens: (_tokens$data$asSymbol = tokens.data.asSymbol) === null || _tokens$data$asSymbol === void 0 ? void 0 : _tokens$data$asSymbol.map(t => t.id),\n              id: value\n            }\n          });\n          setSearchedPairs(updateNameData(pairs.data.as0).concat(updateNameData(pairs.data.as1)).concat(updateNameData(pairs.data.asAddress)));\n          const foundTokens = tokens.data.asSymbol.concat(tokens.data.asAddress).concat(tokens.data.asName);\n          setSearchedTokens(foundTokens);\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    }\n\n    fetchData();\n  }, [value]);\n\n  function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n  } // add the searched tokens to the list if not found yet\n\n\n  allTokens = allTokens.concat(searchedTokens.filter(searchedToken => {\n    let included = false;\n    updateNameData();\n    allTokens.map(token => {\n      if (token.id === searchedToken.id) {\n        included = true;\n      }\n\n      return true;\n    });\n    return !included;\n  }));\n  let uniqueTokens = [];\n  let found = {};\n  allTokens && allTokens.map(token => {\n    if (!found[token.id]) {\n      found[token.id] = true;\n      uniqueTokens.push(token);\n    }\n\n    return true;\n  });\n  allPairs = allPairs.concat(searchedPairs.filter(searchedPair => {\n    let included = false;\n    allPairs.map(pair => {\n      if (pair.id === searchedPair.id) {\n        included = true;\n      }\n\n      return true;\n    });\n    return !included;\n  }));\n  let uniquePairs = [];\n  let pairsFound = {};\n  allPairs && allPairs.map(pair => {\n    if (!pairsFound[pair.id]) {\n      pairsFound[pair.id] = true;\n      uniquePairs.push(pair);\n    }\n\n    return true;\n  });\n  const filteredTokenList = useMemo(() => {\n    return uniqueTokens ? uniqueTokens.sort((a, b) => {\n      if (OVERVIEW_TOKEN_BLACKLIST.includes(a.id)) {\n        return 1;\n      }\n\n      if (OVERVIEW_TOKEN_BLACKLIST.includes(b.id)) {\n        return -1;\n      }\n\n      const tokenA = allTokenData[a.id];\n      const tokenB = allTokenData[b.id];\n\n      if ((tokenA === null || tokenA === void 0 ? void 0 : tokenA.oneDayVolumeUSD) && (tokenB === null || tokenB === void 0 ? void 0 : tokenB.oneDayVolumeUSD)) {\n        return tokenA.oneDayVolumeUSD > tokenB.oneDayVolumeUSD ? -1 : 1;\n      }\n\n      if ((tokenA === null || tokenA === void 0 ? void 0 : tokenA.oneDayVolumeUSD) && !(tokenB === null || tokenB === void 0 ? void 0 : tokenB.oneDayVolumeUSD)) {\n        return -1;\n      }\n\n      if (!(tokenA === null || tokenA === void 0 ? void 0 : tokenA.oneDayVolumeUSD) && (tokenB === null || tokenB === void 0 ? void 0 : tokenB.oneDayVolumeUSD)) {\n        return (tokenA === null || tokenA === void 0 ? void 0 : tokenA.totalLiquidity) > (tokenB === null || tokenB === void 0 ? void 0 : tokenB.totalLiquidity) ? -1 : 1;\n      }\n\n      return 1;\n    }).filter(token => {\n      if (OVERVIEW_TOKEN_BLACKLIST.includes(token.id)) {\n        return false;\n      }\n\n      const regexMatches = Object.keys(token).map(tokenEntryKey => {\n        const isAddress = value.slice(0, 2) === '0x';\n\n        if (tokenEntryKey === 'id' && isAddress) {\n          return token[tokenEntryKey].match(new RegExp(escapeRegExp(value), 'i'));\n        }\n\n        if (tokenEntryKey === 'symbol' && !isAddress) {\n          return token[tokenEntryKey].match(new RegExp(escapeRegExp(value), 'i'));\n        }\n\n        if (tokenEntryKey === 'name' && !isAddress) {\n          return token[tokenEntryKey].match(new RegExp(escapeRegExp(value), 'i'));\n        }\n\n        return false;\n      });\n      return regexMatches.some(m => m);\n    }) : [];\n  }, [allTokenData, uniqueTokens, value]);\n  const filteredPairList = useMemo(() => {\n    return uniquePairs ? uniquePairs.sort((a, b) => {\n      const pairA = allPairData[a.id];\n      const pairB = allPairData[b.id];\n\n      if ((pairA === null || pairA === void 0 ? void 0 : pairA.trackedReserveBNB) && (pairB === null || pairB === void 0 ? void 0 : pairB.trackedReserveBNB)) {\n        return parseFloat(pairA.trackedReserveBNB) > parseFloat(pairB.trackedReserveBNB) ? -1 : 1;\n      }\n\n      if ((pairA === null || pairA === void 0 ? void 0 : pairA.trackedReserveBNB) && !(pairB === null || pairB === void 0 ? void 0 : pairB.trackedReserveBNB)) {\n        return -1;\n      }\n\n      if (!(pairA === null || pairA === void 0 ? void 0 : pairA.trackedReserveBNB) && (pairB === null || pairB === void 0 ? void 0 : pairB.trackedReserveBNB)) {\n        return 1;\n      }\n\n      return 0;\n    }).filter(pair => {\n      if (PAIR_BLACKLIST.includes(pair.id)) {\n        return false;\n      }\n\n      if (value && value.includes(' ')) {\n        var _value$split$, _value$split$2;\n\n        const pairA = (_value$split$ = value.split(' ')[0]) === null || _value$split$ === void 0 ? void 0 : _value$split$.toUpperCase();\n        const pairB = (_value$split$2 = value.split(' ')[1]) === null || _value$split$2 === void 0 ? void 0 : _value$split$2.toUpperCase();\n        return (pair.token0.symbol.includes(pairA) || pair.token0.symbol.includes(pairB)) && (pair.token1.symbol.includes(pairA) || pair.token1.symbol.includes(pairB));\n      }\n\n      if (value && value.includes('-')) {\n        var _value$split$3, _value$split$4;\n\n        const pairA = (_value$split$3 = value.split('-')[0]) === null || _value$split$3 === void 0 ? void 0 : _value$split$3.toUpperCase();\n        const pairB = (_value$split$4 = value.split('-')[1]) === null || _value$split$4 === void 0 ? void 0 : _value$split$4.toUpperCase();\n        return (pair.token0.symbol.includes(pairA) || pair.token0.symbol.includes(pairB)) && (pair.token1.symbol.includes(pairA) || pair.token1.symbol.includes(pairB));\n      }\n\n      const regexMatches = Object.keys(pair).map(field => {\n        const isAddress = value.slice(0, 2) === '0x';\n\n        if (field === 'id' && isAddress) {\n          return pair[field].match(new RegExp(escapeRegExp(value), 'i'));\n        }\n\n        if (field === 'token0') {\n          return pair[field].symbol.match(new RegExp(escapeRegExp(value), 'i')) || pair[field].name.match(new RegExp(escapeRegExp(value), 'i'));\n        }\n\n        if (field === 'token1') {\n          return pair[field].symbol.match(new RegExp(escapeRegExp(value), 'i')) || pair[field].name.match(new RegExp(escapeRegExp(value), 'i'));\n        }\n\n        return false;\n      });\n      return regexMatches.some(m => m);\n    }) : [];\n  }, [allPairData, uniquePairs, value]);\n  useEffect(() => {\n    if (Object.keys(filteredTokenList).length > 2) {\n      toggleShadow(true);\n    } else {\n      toggleShadow(false);\n    }\n  }, [filteredTokenList]);\n  useEffect(() => {\n    if (Object.keys(filteredPairList).length > 2) {\n      toggleBottomShadow(true);\n    } else {\n      toggleBottomShadow(false);\n    }\n  }, [filteredPairList]);\n  const [tokensShown, setTokensShown] = useState(3);\n  const [pairsShown, setPairsShown] = useState(3);\n\n  function onDismiss() {\n    setPairsShown(3);\n    setTokensShown(3);\n    toggleMenu(false);\n    setValue('');\n  } // refs to detect clicks outside modal\n\n\n  const wrapperRef = useRef();\n  const menuRef = useRef();\n\n  const handleClick = e => {\n    if (!(menuRef.current && menuRef.current.contains(e.target)) && !(wrapperRef.current && wrapperRef.current.contains(e.target))) {\n      setPairsShown(3);\n      setTokensShown(3);\n      toggleMenu(false);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('click', handleClick);\n    return () => {\n      document.removeEventListener('click', handleClick);\n    };\n  });\n  return React.createElement(Container, {\n    small: small,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428\n    },\n    __self: this\n  }, React.createElement(Wrapper, {\n    open: showMenu,\n    shadow: true,\n    small: small,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429\n    },\n    __self: this\n  }, React.createElement(Input, {\n    large: !small,\n    type: 'text',\n    ref: wrapperRef,\n    placeholder: small ? '' : below410 ? 'Search...' : below470 ? 'Search ViralSwap...' : below700 ? 'Search pairs and tokens...' : 'Search ViralSwap pairs and tokens...',\n    value: value,\n    onChange: e => {\n      setValue(e.target.value);\n    },\n    onFocus: () => {\n      if (!showMenu) {\n        toggleMenu(true);\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430\n    },\n    __self: this\n  }), !showMenu ? React.createElement(SearchIconLarge, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 455\n    },\n    __self: this\n  }) : React.createElement(CloseIcon, {\n    onClick: () => toggleMenu(false),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 455\n    },\n    __self: this\n  })), React.createElement(Menu, {\n    hide: !showMenu,\n    ref: menuRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457\n    },\n    __self: this\n  }, React.createElement(Heading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458\n    },\n    __self: this\n  }, React.createElement(Gray, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459\n    },\n    __self: this\n  }, \"Pairs\")), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 461\n    },\n    __self: this\n  }, filteredPairList && Object.keys(filteredPairList).length === 0 && React.createElement(MenuItem, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 463\n    },\n    __self: this\n  }, React.createElement(TYPE.body, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464\n    },\n    __self: this\n  }, \"No results\")), filteredPairList && filteredPairList.slice(0, pairsShown).map(pair => {\n    var _pair$token, _pair$token2;\n\n    //format incorrect names\n    updateNameData(pair);\n    return React.createElement(BasicLink, {\n      to: '/pair/' + pair.id,\n      key: pair.id,\n      onClick: onDismiss,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 472\n      },\n      __self: this\n    }, React.createElement(MenuItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 473\n      },\n      __self: this\n    }, React.createElement(DoubleTokenLogo, {\n      a0: pair === null || pair === void 0 ? void 0 : (_pair$token = pair.token0) === null || _pair$token === void 0 ? void 0 : _pair$token.id,\n      a1: pair === null || pair === void 0 ? void 0 : (_pair$token2 = pair.token1) === null || _pair$token2 === void 0 ? void 0 : _pair$token2.id,\n      margin: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 474\n      },\n      __self: this\n    }), React.createElement(TYPE.body, {\n      style: {\n        marginLeft: '10px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475\n      },\n      __self: this\n    }, pair.token0.symbol + '-' + pair.token1.symbol, \" Pair\")));\n  }), React.createElement(Heading, {\n    hide: !(Object.keys(filteredPairList).length > 3 && Object.keys(filteredPairList).length >= pairsShown),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 482\n    },\n    __self: this\n  }, React.createElement(Blue, {\n    onClick: () => {\n      setPairsShown(pairsShown + 5);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 485\n    },\n    __self: this\n  }, \"See more...\"))), React.createElement(Heading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 494\n    },\n    __self: this\n  }, React.createElement(Gray, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 495\n    },\n    __self: this\n  }, \"Tokens\")), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 497\n    },\n    __self: this\n  }, Object.keys(filteredTokenList).length === 0 && React.createElement(MenuItem, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 499\n    },\n    __self: this\n  }, React.createElement(TYPE.body, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500\n    },\n    __self: this\n  }, \"No results\")), filteredTokenList.slice(0, tokensShown).map(token => {\n    // update displayed names\n    updateNameData({\n      token0: token\n    });\n    return React.createElement(BasicLink, {\n      to: '/token/' + token.id,\n      key: token.id,\n      onClick: onDismiss,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507\n      },\n      __self: this\n    }, React.createElement(MenuItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 508\n      },\n      __self: this\n    }, React.createElement(RowFixed, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 509\n      },\n      __self: this\n    }, React.createElement(TokenLogo, {\n      address: token.id,\n      style: {\n        marginRight: '10px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 510\n      },\n      __self: this\n    }), React.createElement(FormattedName, {\n      text: token.name,\n      maxCharacters: 20,\n      style: {\n        marginRight: '6px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 511\n      },\n      __self: this\n    }), \"(\", React.createElement(FormattedName, {\n      text: token.symbol,\n      maxCharacters: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 512\n      },\n      __self: this\n    }), \")\")));\n  }), React.createElement(Heading, {\n    hide: !(Object.keys(filteredTokenList).length > 3 && Object.keys(filteredTokenList).length >= tokensShown),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 519\n    },\n    __self: this\n  }, React.createElement(Blue, {\n    onClick: () => {\n      setTokensShown(tokensShown + 5);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 522\n    },\n    __self: this\n  }, \"See more...\")))));\n};\nexport default Search;","map":{"version":3,"sources":["B:/2021/1219_ViralCoin/work/NewSubgraph/pancake-info-v1/src/components/Search/index.js"],"names":["React","useState","useEffect","useMemo","useRef","styled","Row","RowFixed","TokenLogo","Search","SearchIcon","X","BasicLink","useAllTokenData","useTokenData","useAllPairData","usePairData","DoubleTokenLogo","useMedia","useAllPairsInUniswap","useAllTokensInUniswap","OVERVIEW_TOKEN_BLACKLIST","PAIR_BLACKLIST","transparentize","client","PAIR_SEARCH","TOKEN_SEARCH","FormattedName","TYPE","updateNameData","Container","div","Wrapper","theme","small","open","bg1","bg6","Input","input","text1","large","text3","SearchIconLarge","CloseIcon","Menu","hide","MenuItem","bg2","Heading","Gray","span","Blue","allTokens","allTokenData","allPairs","allPairData","showMenu","toggleMenu","value","setValue","toggleShadow","toggleBottomShadow","below700","below470","below410","searchedTokens","setSearchedTokens","searchedPairs","setSearchedPairs","fetchData","length","tokens","query","variables","toUpperCase","id","pairs","data","asSymbol","map","t","as0","concat","as1","asAddress","foundTokens","asName","e","console","log","escapeRegExp","string","replace","filter","searchedToken","included","token","uniqueTokens","found","push","searchedPair","pair","uniquePairs","pairsFound","filteredTokenList","sort","a","b","includes","tokenA","tokenB","oneDayVolumeUSD","totalLiquidity","regexMatches","Object","keys","tokenEntryKey","isAddress","slice","match","RegExp","some","m","filteredPairList","pairA","pairB","trackedReserveBNB","parseFloat","split","token0","symbol","token1","field","name","tokensShown","setTokensShown","pairsShown","setPairsShown","onDismiss","wrapperRef","menuRef","handleClick","current","contains","target","document","addEventListener","removeEventListener","marginLeft","marginRight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport Row, { RowFixed } from '../Row'\r\nimport TokenLogo from '../TokenLogo'\r\nimport { Search as SearchIcon, X } from 'react-feather'\r\nimport { BasicLink } from '../Link'\r\n\r\nimport { useAllTokenData, useTokenData } from '../../contexts/TokenData'\r\nimport { useAllPairData, usePairData } from '../../contexts/PairData'\r\nimport DoubleTokenLogo from '../DoubleLogo'\r\nimport { useMedia } from 'react-use'\r\nimport { useAllPairsInUniswap, useAllTokensInUniswap } from '../../contexts/GlobalData'\r\nimport { OVERVIEW_TOKEN_BLACKLIST, PAIR_BLACKLIST } from '../../constants'\r\n\r\nimport { transparentize } from 'polished'\r\nimport { client } from '../../apollo/client'\r\nimport { PAIR_SEARCH, TOKEN_SEARCH } from '../../apollo/queries'\r\nimport FormattedName from '../FormattedName'\r\nimport { TYPE } from '../../Theme'\r\nimport { updateNameData } from '../../utils/data'\r\n\r\nconst Container = styled.div`\r\n  height: 48px;\r\n  z-index: 30;\r\n  position: relative;\r\n\r\n  @media screen and (max-width: 600px) {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst Wrapper = styled.div`\r\n  display: flex;\r\n  position: relative;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  padding: 12px 16px;\r\n  border-radius: 12px;\r\n  background: ${({ theme, small, open }) =>\r\n    small ? (open ? transparentize(0.4, theme.bg1) : 'none') : transparentize(0.4, theme.bg6)};\r\n  border-bottom-right-radius: ${({ open }) => (open ? '0px' : '12px')};\r\n  border-bottom-left-radius: ${({ open }) => (open ? '0px' : '12px')};\r\n  z-index: 9999;\r\n  width: 100%;\r\n  min-width: 300px;\r\n  box-sizing: border-box;\r\n  box-shadow: ${({ open, small }) =>\r\n    !open && !small\r\n      ? '0px 24px 32px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 0px 1px rgba(0, 0, 0, 0.04) '\r\n      : 'none'};\r\n  @media screen and (max-width: 500px) {\r\n    background: ${({ theme }) => transparentize(0.4, theme.bg1)};\r\n    box-shadow: ${({ open }) =>\r\n    !open\r\n      ? '0px 24px 32px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 0px 1px rgba(0, 0, 0, 0.04) '\r\n      : 'none'};\r\n  }\r\n`\r\nconst Input = styled.input`\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  white-space: nowrap;\r\n  background: none;\r\n  border: none;\r\n  outline: none;\r\n  width: 100%;\r\n  color: ${({ theme }) => theme.text1};\r\n  font-size: ${({ large }) => (large ? '20px' : '14px')};\r\n\r\n  ::placeholder {\r\n    color: ${({ theme }) => theme.text3};\r\n    font-size: 16px;\r\n  }\r\n\r\n  @media screen and (max-width: 640px) {\r\n    ::placeholder {\r\n      font-size: 1rem;\r\n    }\r\n  }\r\n`\r\n\r\nconst SearchIconLarge = styled(SearchIcon)`\r\n  height: 20px;\r\n  width: 20px;\r\n  margin-right: 0.5rem;\r\n  position: absolute;\r\n  right: 10px;\r\n  pointer-events: none;\r\n  color: ${({ theme }) => theme.text3};\r\n`\r\n\r\nconst CloseIcon = styled(X)`\r\n  height: 20px;\r\n  width: 20px;\r\n  margin-right: 0.5rem;\r\n  position: absolute;\r\n  right: 10px;\r\n  color: ${({ theme }) => theme.text3};\r\n  :hover {\r\n    cursor: pointer;\r\n  }\r\n`\r\n\r\nconst Menu = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 9999;\r\n  width: 100%;\r\n  top: 50px;\r\n  max-height: 540px;\r\n  overflow: auto;\r\n  left: 0;\r\n  padding-bottom: 20px;\r\n  background: ${({ theme }) => theme.bg6};\r\n  border-bottom-right-radius: 12px;\r\n  border-bottom-left-radius: 12px;\r\n  box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04),\r\n    0px 24px 32px rgba(0, 0, 0, 0.04);\r\n  display: ${({ hide }) => hide && 'none'};\r\n`\r\n\r\nconst MenuItem = styled(Row)`\r\n  padding: 1rem;\r\n  font-size: 0.85rem;\r\n  & > * {\r\n    margin-right: 6px;\r\n  }\r\n  :hover {\r\n    cursor: pointer;\r\n    background-color: ${({ theme }) => theme.bg2};\r\n  }\r\n`\r\n\r\nconst Heading = styled(Row)`\r\n  padding: 1rem;\r\n  display: ${({ hide = false }) => hide && 'none'};\r\n`\r\n\r\nconst Gray = styled.span`\r\n  color: #888d9b;\r\n`\r\n\r\nconst Blue = styled.span`\r\n  color: #2172e5;\r\n  :hover {\r\n    cursor: pointer;\r\n  }\r\n`\r\n\r\nexport const Search = ({ small = false }) => {\r\n  let allTokens = useAllTokensInUniswap()\r\n  const allTokenData = useAllTokenData()\r\n\r\n  let allPairs = useAllPairsInUniswap()\r\n  const allPairData = useAllPairData()\r\n\r\n  const [showMenu, toggleMenu] = useState(false)\r\n  const [value, setValue] = useState('')\r\n  const [, toggleShadow] = useState(false)\r\n  const [, toggleBottomShadow] = useState(false)\r\n\r\n  // fetch new data on tokens and pairs if needed\r\n  useTokenData(value)\r\n  usePairData(value)\r\n\r\n  const below700 = useMedia('(max-width: 700px)')\r\n  const below470 = useMedia('(max-width: 470px)')\r\n  const below410 = useMedia('(max-width: 410px)')\r\n\r\n  useEffect(() => {\r\n    if (value !== '') {\r\n      toggleMenu(true)\r\n    } else {\r\n      toggleMenu(false)\r\n    }\r\n  }, [value])\r\n\r\n  const [searchedTokens, setSearchedTokens] = useState([])\r\n  const [searchedPairs, setSearchedPairs] = useState([])\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        if (value?.length > 0) {\r\n          let tokens = await client.query({\r\n            query: TOKEN_SEARCH,\r\n            variables: {\r\n              value: value ? value.toUpperCase() : '',\r\n              id: value,\r\n            },\r\n          })\r\n\r\n          let pairs = await client.query({\r\n            query: PAIR_SEARCH,\r\n            variables: {\r\n              tokens: tokens.data.asSymbol?.map((t) => t.id),\r\n              id: value,\r\n            },\r\n          })\r\n\r\n          setSearchedPairs(\r\n            updateNameData(pairs.data.as0)\r\n              .concat(updateNameData(pairs.data.as1))\r\n              .concat(updateNameData(pairs.data.asAddress))\r\n          )\r\n          const foundTokens = tokens.data.asSymbol.concat(tokens.data.asAddress).concat(tokens.data.asName)\r\n          setSearchedTokens(foundTokens)\r\n        }\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    }\r\n    fetchData()\r\n  }, [value])\r\n\r\n  function escapeRegExp(string) {\r\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&') // $& means the whole matched string\r\n  }\r\n\r\n  // add the searched tokens to the list if not found yet\r\n  allTokens = allTokens.concat(\r\n    searchedTokens.filter((searchedToken) => {\r\n      let included = false\r\n      updateNameData()\r\n      allTokens.map((token) => {\r\n        if (token.id === searchedToken.id) {\r\n          included = true\r\n        }\r\n        return true\r\n      })\r\n      return !included\r\n    })\r\n  )\r\n\r\n  let uniqueTokens = []\r\n  let found = {}\r\n  allTokens &&\r\n    allTokens.map((token) => {\r\n      if (!found[token.id]) {\r\n        found[token.id] = true\r\n        uniqueTokens.push(token)\r\n      }\r\n      return true\r\n    })\r\n\r\n  allPairs = allPairs.concat(\r\n    searchedPairs.filter((searchedPair) => {\r\n      let included = false\r\n      allPairs.map((pair) => {\r\n        if (pair.id === searchedPair.id) {\r\n          included = true\r\n        }\r\n        return true\r\n      })\r\n      return !included\r\n    })\r\n  )\r\n\r\n  let uniquePairs = []\r\n  let pairsFound = {}\r\n  allPairs &&\r\n    allPairs.map((pair) => {\r\n      if (!pairsFound[pair.id]) {\r\n        pairsFound[pair.id] = true\r\n        uniquePairs.push(pair)\r\n      }\r\n      return true\r\n    })\r\n\r\n  const filteredTokenList = useMemo(() => {\r\n    return uniqueTokens\r\n      ? uniqueTokens\r\n        .sort((a, b) => {\r\n          if (OVERVIEW_TOKEN_BLACKLIST.includes(a.id)) {\r\n            return 1\r\n          }\r\n          if (OVERVIEW_TOKEN_BLACKLIST.includes(b.id)) {\r\n            return -1\r\n          }\r\n          const tokenA = allTokenData[a.id]\r\n          const tokenB = allTokenData[b.id]\r\n          if (tokenA?.oneDayVolumeUSD && tokenB?.oneDayVolumeUSD) {\r\n            return tokenA.oneDayVolumeUSD > tokenB.oneDayVolumeUSD ? -1 : 1\r\n          }\r\n          if (tokenA?.oneDayVolumeUSD && !tokenB?.oneDayVolumeUSD) {\r\n            return -1\r\n          }\r\n          if (!tokenA?.oneDayVolumeUSD && tokenB?.oneDayVolumeUSD) {\r\n            return tokenA?.totalLiquidity > tokenB?.totalLiquidity ? -1 : 1\r\n          }\r\n          return 1\r\n        })\r\n        .filter((token) => {\r\n          if (OVERVIEW_TOKEN_BLACKLIST.includes(token.id)) {\r\n            return false\r\n          }\r\n          const regexMatches = Object.keys(token).map((tokenEntryKey) => {\r\n            const isAddress = value.slice(0, 2) === '0x'\r\n            if (tokenEntryKey === 'id' && isAddress) {\r\n              return token[tokenEntryKey].match(new RegExp(escapeRegExp(value), 'i'))\r\n            }\r\n            if (tokenEntryKey === 'symbol' && !isAddress) {\r\n              return token[tokenEntryKey].match(new RegExp(escapeRegExp(value), 'i'))\r\n            }\r\n            if (tokenEntryKey === 'name' && !isAddress) {\r\n              return token[tokenEntryKey].match(new RegExp(escapeRegExp(value), 'i'))\r\n            }\r\n            return false\r\n          })\r\n          return regexMatches.some((m) => m)\r\n        })\r\n      : []\r\n  }, [allTokenData, uniqueTokens, value])\r\n\r\n  const filteredPairList = useMemo(() => {\r\n    return uniquePairs\r\n      ? uniquePairs\r\n        .sort((a, b) => {\r\n          const pairA = allPairData[a.id]\r\n          const pairB = allPairData[b.id]\r\n          if (pairA?.trackedReserveBNB && pairB?.trackedReserveBNB) {\r\n            return parseFloat(pairA.trackedReserveBNB) > parseFloat(pairB.trackedReserveBNB) ? -1 : 1\r\n          }\r\n          if (pairA?.trackedReserveBNB && !pairB?.trackedReserveBNB) {\r\n            return -1\r\n          }\r\n          if (!pairA?.trackedReserveBNB && pairB?.trackedReserveBNB) {\r\n            return 1\r\n          }\r\n          return 0\r\n        })\r\n        .filter((pair) => {\r\n          if (PAIR_BLACKLIST.includes(pair.id)) {\r\n            return false\r\n          }\r\n          if (value && value.includes(' ')) {\r\n            const pairA = value.split(' ')[0]?.toUpperCase()\r\n            const pairB = value.split(' ')[1]?.toUpperCase()\r\n            return (\r\n              (pair.token0.symbol.includes(pairA) || pair.token0.symbol.includes(pairB)) &&\r\n              (pair.token1.symbol.includes(pairA) || pair.token1.symbol.includes(pairB))\r\n            )\r\n          }\r\n          if (value && value.includes('-')) {\r\n            const pairA = value.split('-')[0]?.toUpperCase()\r\n            const pairB = value.split('-')[1]?.toUpperCase()\r\n            return (\r\n              (pair.token0.symbol.includes(pairA) || pair.token0.symbol.includes(pairB)) &&\r\n              (pair.token1.symbol.includes(pairA) || pair.token1.symbol.includes(pairB))\r\n            )\r\n          }\r\n          const regexMatches = Object.keys(pair).map((field) => {\r\n            const isAddress = value.slice(0, 2) === '0x'\r\n            if (field === 'id' && isAddress) {\r\n              return pair[field].match(new RegExp(escapeRegExp(value), 'i'))\r\n            }\r\n            if (field === 'token0') {\r\n              return (\r\n                pair[field].symbol.match(new RegExp(escapeRegExp(value), 'i')) ||\r\n                pair[field].name.match(new RegExp(escapeRegExp(value), 'i'))\r\n              )\r\n            }\r\n            if (field === 'token1') {\r\n              return (\r\n                pair[field].symbol.match(new RegExp(escapeRegExp(value), 'i')) ||\r\n                pair[field].name.match(new RegExp(escapeRegExp(value), 'i'))\r\n              )\r\n            }\r\n            return false\r\n          })\r\n          return regexMatches.some((m) => m)\r\n        })\r\n      : []\r\n  }, [allPairData, uniquePairs, value])\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(filteredTokenList).length > 2) {\r\n      toggleShadow(true)\r\n    } else {\r\n      toggleShadow(false)\r\n    }\r\n  }, [filteredTokenList])\r\n\r\n  useEffect(() => {\r\n    if (Object.keys(filteredPairList).length > 2) {\r\n      toggleBottomShadow(true)\r\n    } else {\r\n      toggleBottomShadow(false)\r\n    }\r\n  }, [filteredPairList])\r\n\r\n  const [tokensShown, setTokensShown] = useState(3)\r\n  const [pairsShown, setPairsShown] = useState(3)\r\n\r\n  function onDismiss() {\r\n    setPairsShown(3)\r\n    setTokensShown(3)\r\n    toggleMenu(false)\r\n    setValue('')\r\n  }\r\n\r\n  // refs to detect clicks outside modal\r\n  const wrapperRef = useRef()\r\n  const menuRef = useRef()\r\n\r\n  const handleClick = (e) => {\r\n    if (\r\n      !(menuRef.current && menuRef.current.contains(e.target)) &&\r\n      !(wrapperRef.current && wrapperRef.current.contains(e.target))\r\n    ) {\r\n      setPairsShown(3)\r\n      setTokensShown(3)\r\n      toggleMenu(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    document.addEventListener('click', handleClick)\r\n    return () => {\r\n      document.removeEventListener('click', handleClick)\r\n    }\r\n  })\r\n\r\n  return (\r\n    <Container small={small}>\r\n      <Wrapper open={showMenu} shadow={true} small={small}>\r\n        <Input\r\n          large={!small}\r\n          type={'text'}\r\n          ref={wrapperRef}\r\n          placeholder={\r\n            small\r\n              ? ''\r\n              : below410\r\n                ? 'Search...'\r\n                : below470\r\n                  ? 'Search ViralSwap...'\r\n                  : below700\r\n                    ? 'Search pairs and tokens...'\r\n                    : 'Search ViralSwap pairs and tokens...'\r\n          }\r\n          value={value}\r\n          onChange={(e) => {\r\n            setValue(e.target.value)\r\n          }}\r\n          onFocus={() => {\r\n            if (!showMenu) {\r\n              toggleMenu(true)\r\n            }\r\n          }}\r\n        />\r\n        {!showMenu ? <SearchIconLarge /> : <CloseIcon onClick={() => toggleMenu(false)} />}\r\n      </Wrapper>\r\n      <Menu hide={!showMenu} ref={menuRef}>\r\n        <Heading>\r\n          <Gray>Pairs</Gray>\r\n        </Heading>\r\n        <div>\r\n          {filteredPairList && Object.keys(filteredPairList).length === 0 && (\r\n            <MenuItem>\r\n              <TYPE.body>No results</TYPE.body>\r\n            </MenuItem>\r\n          )}\r\n          {filteredPairList &&\r\n            filteredPairList.slice(0, pairsShown).map((pair) => {\r\n              //format incorrect names\r\n              updateNameData(pair)\r\n              return (\r\n                <BasicLink to={'/pair/' + pair.id} key={pair.id} onClick={onDismiss}>\r\n                  <MenuItem>\r\n                    <DoubleTokenLogo a0={pair?.token0?.id} a1={pair?.token1?.id} margin={true} />\r\n                    <TYPE.body style={{ marginLeft: '10px' }}>\r\n                      {pair.token0.symbol + '-' + pair.token1.symbol} Pair\r\n                    </TYPE.body>\r\n                  </MenuItem>\r\n                </BasicLink>\r\n              )\r\n            })}\r\n          <Heading\r\n            hide={!(Object.keys(filteredPairList).length > 3 && Object.keys(filteredPairList).length >= pairsShown)}\r\n          >\r\n            <Blue\r\n              onClick={() => {\r\n                setPairsShown(pairsShown + 5)\r\n              }}\r\n            >\r\n              See more...\r\n            </Blue>\r\n          </Heading>\r\n        </div>\r\n        <Heading>\r\n          <Gray>Tokens</Gray>\r\n        </Heading>\r\n        <div>\r\n          {Object.keys(filteredTokenList).length === 0 && (\r\n            <MenuItem>\r\n              <TYPE.body>No results</TYPE.body>\r\n            </MenuItem>\r\n          )}\r\n          {filteredTokenList.slice(0, tokensShown).map((token) => {\r\n            // update displayed names\r\n            updateNameData({ token0: token })\r\n            return (\r\n              <BasicLink to={'/token/' + token.id} key={token.id} onClick={onDismiss}>\r\n                <MenuItem>\r\n                  <RowFixed>\r\n                    <TokenLogo address={token.id} style={{ marginRight: '10px' }} />\r\n                    <FormattedName text={token.name} maxCharacters={20} style={{ marginRight: '6px' }} />\r\n                    (<FormattedName text={token.symbol} maxCharacters={6} />)\r\n                  </RowFixed>\r\n                </MenuItem>\r\n              </BasicLink>\r\n            )\r\n          })}\r\n\r\n          <Heading\r\n            hide={!(Object.keys(filteredTokenList).length > 3 && Object.keys(filteredTokenList).length >= tokensShown)}\r\n          >\r\n            <Blue\r\n              onClick={() => {\r\n                setTokensShown(tokensShown + 5)\r\n              }}\r\n            >\r\n              See more...\r\n            </Blue>\r\n          </Heading>\r\n        </div>\r\n      </Menu>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default Search\r\n"]},"metadata":{},"sourceType":"module"}